---

title: Simulation interface

keywords: fastai
sidebar: home_sidebar

summary: "Main simulation class and command line client"
description: "Main simulation class and command line client"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 04_cli.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">hashlib</span>

<span class="k">def</span> <span class="nf">md5sum_string</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">md5sum_file</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute md5 checksum of the contents of a file&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">md5sum_string</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="md5sum_string" class="doc_header"><code>md5sum_string</code><a href="https://github.com/cmb-s4/s4_design_sim_tool/tree/master/s4_design_sim_tool/cli.py#L27" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>md5sum_string</code>(<strong><code>string</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="md5sum_file" class="doc_header"><code>md5sum_file</code><a href="https://github.com/cmb-s4/s4_design_sim_tool/tree/master/s4_design_sim_tool/cli.py#L30" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>md5sum_file</code>(<strong><code>filename</code></strong>)</p>
</blockquote>

<pre><code>Compute md5 checksum of the contents of a file</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">console_md5sum</span> <span class="o">=</span> <span class="o">!</span>md5sum s4_reference_design.toml
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">md5sum_file</span><span class="p">(</span><span class="s2">&quot;s4_reference_design.toml&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">console_md5sum</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">S4RefSimTool</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_filename</span><span class="p">,</span> <span class="n">output_folder</span><span class="o">=</span><span class="s2">&quot;output&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Simulate CMB-S4 maps based on the experiment configuration</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        config : filename</span>
<span class="sd">            CMB-S4 configuration stored in a TOML file</span>
<span class="sd">            see for example s4_reference_design.toml in the repository</span>
<span class="sd">        output_folder : str or Path</span>
<span class="sd">            Output path</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_filename</span> <span class="o">=</span> <span class="n">config_filename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">toml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_filename_template</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;cmbs4_</span><span class="si">{tag}</span><span class="s2">_KCMB_</span><span class="si">{telescope}</span><span class="s2">-</span><span class="si">{band}</span><span class="s2">_nside</span><span class="si">{nside}</span><span class="s2">_</span><span class="si">{split}</span><span class="s2">_of_</span><span class="si">{nsplits}</span><span class="s2">.fits&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">output_folder</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Pole&quot;</span><span class="p">,</span> <span class="s2">&quot;Chile&quot;</span><span class="p">],</span> <span class="n">write_outputs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run the simulation</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        channels : str or list[str]</span>
<span class="sd">            list of channel tags, e.g.</span>
<span class="sd">            * [&quot;LFS1&quot;, &quot;LFS2&quot;] or</span>
<span class="sd">            * &quot;SAT&quot; or &quot;LAT&quot;</span>
<span class="sd">            * &quot;all&quot; (default)</span>
<span class="sd">        site : list[str]</span>
<span class="sd">            [&#39;Pole&#39;] or [&#39;Chile&#39;], by default [&quot;Pole&quot;, &quot;Chile&quot;]</span>
<span class="sd">        write_outputs : bool</span>
<span class="sd">            if True write the outputs to disk, if False return them (not implemented yet)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nsplits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;experiment&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;number_of_splits&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="n">nsplits</span> <span class="o">&lt;</span> <span class="mi">8</span>
        <span class="p">),</span> <span class="s2">&quot;We currently only have 7 independent realizations of atmosphere and noise&quot;</span>
        <span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">sites</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">channel</span> <span class="ow">in</span> <span class="n">parse_channels</span><span class="p">(</span><span class="n">channels</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">get_telecope_years</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">,</span> <span class="n">site</span><span class="p">,</span> <span class="n">channel</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Simulate channel </span><span class="si">{channel}</span><span class="s2"> at </span><span class="si">{site}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">sky_emission</span> <span class="o">=</span> <span class="n">load_sky_emission</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;sky_emission&quot;</span><span class="p">],</span> <span class="n">site</span><span class="p">,</span> <span class="n">channel</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">split</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsplits</span><span class="p">):</span>
                    <span class="n">output_map</span> <span class="o">=</span> <span class="n">load_atmosphere</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">,</span> <span class="n">site</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">realization</span><span class="o">=</span><span class="n">split</span>
                    <span class="p">)</span>
                    <span class="n">output_map</span> <span class="o">+=</span> <span class="n">load_noise</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">,</span> <span class="n">site</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">realization</span><span class="o">=</span><span class="n">split</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="n">split</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">output_map</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">nsplits</span><span class="p">)</span>
                    <span class="n">output_map</span> <span class="o">+=</span> <span class="n">sky_emission</span>
                    <span class="k">if</span> <span class="n">write_outputs</span><span class="p">:</span>
                        <span class="n">output_filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_filename_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="n">nside</span><span class="o">=</span><span class="n">hp</span><span class="o">.</span><span class="n">npix2nside</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">output_map</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span>
                            <span class="n">telescope</span><span class="o">=</span><span class="n">get_telescope</span><span class="p">(</span><span class="n">channel</span><span class="p">),</span>
                            <span class="n">band</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span>
                            <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;sky_atmosphere_noise&quot;</span><span class="p">,</span>
                            <span class="n">split</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span>
                                <span class="mi">1</span><span class="p">,</span> <span class="n">split</span>
                            <span class="p">),</span>  <span class="c1"># split=0 is full mission and we want 1</span>
                            <span class="n">nsplits</span><span class="o">=</span><span class="n">nsplits</span><span class="p">,</span>
                        <span class="p">)</span>
                        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Writing </span><span class="si">{output_filename}</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">hp</span><span class="o">.</span><span class="n">write_map</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span> <span class="o">/</span> <span class="n">output_filename</span><span class="p">,</span>
                            <span class="n">output_map</span><span class="p">,</span>
                            <span class="n">column_units</span><span class="o">=</span><span class="s2">&quot;K_CMB&quot;</span><span class="p">,</span>
                            <span class="n">extra_header</span><span class="o">=</span><span class="p">[</span>
                                <span class="p">(</span><span class="s2">&quot;SOFTWARE&quot;</span><span class="p">,</span> <span class="s2">&quot;s4_design_sim_tool&quot;</span><span class="p">),</span>
                                <span class="p">(</span><span class="s2">&quot;SW_VERS&quot;</span><span class="p">,</span> <span class="n">__version__</span><span class="p">),</span>
                                <span class="p">(</span><span class="s2">&quot;SKY_VERS&quot;</span><span class="p">,</span> <span class="s2">&quot;1.0&quot;</span><span class="p">),</span>
                                <span class="p">(</span><span class="s2">&quot;ATM_VERS&quot;</span><span class="p">,</span> <span class="s2">&quot;1.0&quot;</span><span class="p">),</span>
                                <span class="p">(</span><span class="s2">&quot;NOI_VERS&quot;</span><span class="p">,</span> <span class="s2">&quot;1.0&quot;</span><span class="p">),</span>
                                <span class="p">(</span><span class="s2">&quot;DATE&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">())),</span>
                                <span class="p">(</span><span class="s2">&quot;CONFMD5&quot;</span><span class="p">,</span> <span class="n">md5sum_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_filename</span><span class="p">)),</span>
                            <span class="p">],</span>
                            <span class="n">coord</span><span class="o">=</span><span class="s2">&quot;Q&quot;</span><span class="p">,</span>
                            <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Only writing FITS output for now&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="S4RefSimTool" class="doc_header"><code>class</code> <code>S4RefSimTool</code><a href="https://github.com/cmb-s4/s4_design_sim_tool/tree/master/s4_design_sim_tool/cli.py#L37" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>S4RefSimTool</code>(<strong><code>config_filename</code></strong>, <strong><code>output_folder</code></strong>=<em><code>'output'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">command_line_script</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

    <span class="kn">import</span> <span class="nn">logging</span> <span class="k">as</span> <span class="nn">log</span>

    <span class="n">log</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">log</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

    <span class="kn">import</span> <span class="nn">argparse</span>

    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Run s4_design_sim_tool&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;config&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Configuration file&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--channels&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Channels e.g. all, SAT, LAT, LFL1 or comma separated list of channels&quot;</span><span class="p">,</span>
        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--site&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Pole, Chile or all, default all&quot;</span><span class="p">,</span>
        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--output_folder&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Output folder, optional&quot;</span><span class="p">,</span>
        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;output&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">site</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
        <span class="n">sites</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Chile&quot;</span><span class="p">,</span> <span class="s2">&quot;Pole&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sites</span> <span class="o">=</span> <span class="p">[</span><span class="n">res</span><span class="o">.</span><span class="n">site</span><span class="p">]</span>
    <span class="n">sim</span> <span class="o">=</span> <span class="n">S4RefSimTool</span><span class="p">(</span><span class="s2">&quot;s4_reference_design.toml&quot;</span><span class="p">,</span> <span class="n">output_folder</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">output_folder</span><span class="p">)</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">channels</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">channels</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="n">sites</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="command_line_script" class="doc_header"><code>command_line_script</code><a href="https://github.com/cmb-s4/s4_design_sim_tool/tree/master/s4_design_sim_tool/cli.py#L128" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>command_line_script</code>(<strong><code>args</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">log</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span> <span class="o">=</span> <span class="n">log</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">S4RefSimTool</span><span class="p">(</span><span class="s2">&quot;s4_reference_design.toml&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">ls</span> /global/cscratch1/sd/keskital/s4sim/reference_tool/out/00000000/*atmo*
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>/global/cscratch1/sd/keskital/s4sim/reference_tool/out/00000000/chile_atmosphere_LAT_HFL1_filtered_telescope_all_time_all_bmap.fits
/global/cscratch1/sd/keskital/s4sim/reference_tool/out/00000000/chile_atmosphere_LAT_HFL2_filtered_telescope_all_time_all_bmap.fits
/global/cscratch1/sd/keskital/s4sim/reference_tool/out/00000000/chile_atmosphere_LAT_LFL1_filtered_telescope_all_time_all_bmap.fits
/global/cscratch1/sd/keskital/s4sim/reference_tool/out/00000000/chile_atmosphere_LAT_LFL2_filtered_telescope_all_time_all_bmap.fits
/global/cscratch1/sd/keskital/s4sim/reference_tool/out/00000000/chile_atmosphere_LAT_MFL1_filtered_telescope_all_time_all_bmap.fits
/global/cscratch1/sd/keskital/s4sim/reference_tool/out/00000000/chile_atmosphere_SAT_LFS1_filtered_telescope_all_time_all_bmap.fits
/global/cscratch1/sd/keskital/s4sim/reference_tool/out/00000000/chile_atmosphere_SAT_LFS2_filtered_telescope_all_time_all_bmap.fits
/global/cscratch1/sd/keskital/s4sim/reference_tool/out/00000000/chile_atmosphere_SAT_MFHS1_filtered_telescope_all_time_all_bmap.fits
/global/cscratch1/sd/keskital/s4sim/reference_tool/out/00000000/chile_atmosphere_SAT_MFHS2_filtered_telescope_all_time_all_bmap.fits
/global/cscratch1/sd/keskital/s4sim/reference_tool/out/00000000/chile_atmosphere_SAT_MFLS1_filtered_telescope_all_time_all_bmap.fits
/global/cscratch1/sd/keskital/s4sim/reference_tool/out/00000000/chile_atmosphere_SAT_MFLS2_filtered_telescope_all_time_all_bmap.fits
/global/cscratch1/sd/keskital/s4sim/reference_tool/out/00000000/pole_atmosphere_LAT_HFL1_filtered_telescope_all_time_all_bmap.fits
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">channels</span><span class="o">=</span><span class="s2">&quot;LFS1&quot;</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Pole&quot;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO:root:Simulate channel LFS1 at Pole
INFO:root:Processing foreground_emission
/global/homes/z/zonca/condajupynersc/lib/python3.6/site-packages/healpy/fitsfunc.py:352: UserWarning: If you are not specifying the input dtype and using the default np.float64 dtype of read_map(), please consider that it will change in a future version to None as to keep the same dtype of the input file: please explicitly set the dtype if it is important to you.
  &#34;If you are not specifying the input dtype and using the default &#34;
INFO:root:Processing CMB_unlensed
INFO:root:Processing CMB_lensing_signal
INFO:root:Processing CMB_tensor_to_scalar_ratio
INFO:root:Reading 00000000/pole_atmosphere_SAT_LFS1_filtered_telescope_all_time_all_bmap.fits
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-12-c4cabe2787ff&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>sim<span class="ansi-blue-fg">.</span>run<span class="ansi-blue-fg">(</span>channels<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#34;LFS1&#34;</span><span class="ansi-blue-fg">,</span> sites<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#34;Pole&#34;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">&lt;ipython-input-7-8a34ca12d6f3&gt;</span> in <span class="ansi-cyan-fg">run</span><span class="ansi-blue-fg">(self, channels, sites, write_outputs)</span>
<span class="ansi-green-intense-fg ansi-bold">     51</span>                 <span class="ansi-green-fg">for</span> split <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>nsplits<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     52</span>                     output_map = load_atmosphere(
<span class="ansi-green-fg">---&gt; 53</span><span class="ansi-red-fg">                         </span>self<span class="ansi-blue-fg">.</span>config<span class="ansi-blue-fg">,</span> site<span class="ansi-blue-fg">,</span> channel<span class="ansi-blue-fg">,</span> realization<span class="ansi-blue-fg">=</span>split
<span class="ansi-green-intense-fg ansi-bold">     54</span>                     )
<span class="ansi-green-intense-fg ansi-bold">     55</span>                     output_map += load_noise(

<span class="ansi-green-fg">/global/project/projectdirs/planck/software/zonca/software/s4refsimtool/s4_design_sim_tool/atmosphere.py</span> in <span class="ansi-cyan-fg">load_atmosphere</span><span class="ansi-blue-fg">(config, site, channel, realization)</span>
<span class="ansi-green-intense-fg ansi-bold">     66</span>     log<span class="ansi-blue-fg">.</span>info<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#34;Reading {map_filename}&#34;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     67</span>     atmosphere_map = hp.read_map(
<span class="ansi-green-fg">---&gt; 68</span><span class="ansi-red-fg">         </span>Path<span class="ansi-blue-fg">(</span>base_folder<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">/</span> map_filename<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> dtype<span class="ansi-blue-fg">=</span>np<span class="ansi-blue-fg">.</span>float32<span class="ansi-blue-fg">,</span> verbose<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span>
<span class="ansi-green-intense-fg ansi-bold">     69</span>     )
<span class="ansi-green-intense-fg ansi-bold">     70</span>     atmosphere_map<span class="ansi-blue-fg">[</span>atmosphere_map <span class="ansi-blue-fg">==</span> hp<span class="ansi-blue-fg">.</span>UNSEEN<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>nan

<span class="ansi-green-fg">~/condajupynersc/lib/python3.6/site-packages/healpy/fitsfunc.py</span> in <span class="ansi-cyan-fg">read_map</span><span class="ansi-blue-fg">(filename, field, dtype, nest, partial, hdu, h, verbose, memmap)</span>
<span class="ansi-green-intense-fg ansi-bold">    356</span>             &#34;important to you.&#34;)
<span class="ansi-green-intense-fg ansi-bold">    357</span> 
<span class="ansi-green-fg">--&gt; 358</span><span class="ansi-red-fg">     </span>fits_hdu <span class="ansi-blue-fg">=</span> _get_hdu<span class="ansi-blue-fg">(</span>filename<span class="ansi-blue-fg">,</span> hdu<span class="ansi-blue-fg">=</span>hdu<span class="ansi-blue-fg">,</span> memmap<span class="ansi-blue-fg">=</span>memmap<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    359</span> 
<span class="ansi-green-intense-fg ansi-bold">    360</span>     nside <span class="ansi-blue-fg">=</span> fits_hdu<span class="ansi-blue-fg">.</span>header<span class="ansi-blue-fg">.</span>get<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;NSIDE&#34;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/condajupynersc/lib/python3.6/site-packages/healpy/fitsfunc.py</span> in <span class="ansi-cyan-fg">_get_hdu</span><span class="ansi-blue-fg">(input_data, hdu, memmap)</span>
<span class="ansi-green-intense-fg ansi-bold">    655</span> 
<span class="ansi-green-intense-fg ansi-bold">    656</span>     <span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>input_data<span class="ansi-blue-fg">,</span> allowed_paths<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 657</span><span class="ansi-red-fg">         </span>hdulist <span class="ansi-blue-fg">=</span> pf<span class="ansi-blue-fg">.</span>open<span class="ansi-blue-fg">(</span>input_data<span class="ansi-blue-fg">,</span> memmap<span class="ansi-blue-fg">=</span>memmap<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    658</span>         <span class="ansi-green-fg">return</span> _get_hdu<span class="ansi-blue-fg">(</span>hdulist<span class="ansi-blue-fg">,</span> hdu<span class="ansi-blue-fg">=</span>hdu<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    659</span> 

<span class="ansi-green-fg">~/condajupynersc/lib/python3.6/site-packages/astropy/io/fits/hdu/hdulist.py</span> in <span class="ansi-cyan-fg">fitsopen</span><span class="ansi-blue-fg">(name, mode, memmap, save_backup, cache, lazy_load_hdus, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    156</span> 
<span class="ansi-green-intense-fg ansi-bold">    157</span>     return HDUList.fromfile(name, mode, memmap, save_backup, cache,
<span class="ansi-green-fg">--&gt; 158</span><span class="ansi-red-fg">                             lazy_load_hdus, **kwargs)
</span><span class="ansi-green-intense-fg ansi-bold">    159</span> 
<span class="ansi-green-intense-fg ansi-bold">    160</span> 

<span class="ansi-green-fg">~/condajupynersc/lib/python3.6/site-packages/astropy/io/fits/hdu/hdulist.py</span> in <span class="ansi-cyan-fg">fromfile</span><span class="ansi-blue-fg">(cls, fileobj, mode, memmap, save_backup, cache, lazy_load_hdus, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    395</span>         return cls._readfrom(fileobj=fileobj, mode=mode, memmap=memmap,
<span class="ansi-green-intense-fg ansi-bold">    396</span>                              save_backup<span class="ansi-blue-fg">=</span>save_backup<span class="ansi-blue-fg">,</span> cache<span class="ansi-blue-fg">=</span>cache<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">--&gt; 397</span><span class="ansi-red-fg">                              lazy_load_hdus=lazy_load_hdus, **kwargs)
</span><span class="ansi-green-intense-fg ansi-bold">    398</span> 
<span class="ansi-green-intense-fg ansi-bold">    399</span>     <span class="ansi-blue-fg">@</span>classmethod

<span class="ansi-green-fg">~/condajupynersc/lib/python3.6/site-packages/astropy/io/fits/hdu/hdulist.py</span> in <span class="ansi-cyan-fg">_readfrom</span><span class="ansi-blue-fg">(cls, fileobj, data, mode, memmap, save_backup, cache, lazy_load_hdus, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   1044</span>             <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> isinstance<span class="ansi-blue-fg">(</span>fileobj<span class="ansi-blue-fg">,</span> _File<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">   1045</span>                 <span class="ansi-red-fg"># instantiate a FITS file object (ffo)</span>
<span class="ansi-green-fg">-&gt; 1046</span><span class="ansi-red-fg">                 </span>fileobj <span class="ansi-blue-fg">=</span> _File<span class="ansi-blue-fg">(</span>fileobj<span class="ansi-blue-fg">,</span> mode<span class="ansi-blue-fg">=</span>mode<span class="ansi-blue-fg">,</span> memmap<span class="ansi-blue-fg">=</span>memmap<span class="ansi-blue-fg">,</span> cache<span class="ansi-blue-fg">=</span>cache<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1047</span>             <span class="ansi-red-fg"># The Astropy mode is determined by the _File initializer if the</span>
<span class="ansi-green-intense-fg ansi-bold">   1048</span>             <span class="ansi-red-fg"># supplied mode was None</span>

<span class="ansi-green-fg">~/condajupynersc/lib/python3.6/site-packages/astropy/utils/decorators.py</span> in <span class="ansi-cyan-fg">wrapper</span><span class="ansi-blue-fg">(*args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    519</span>                             kwargs<span class="ansi-blue-fg">[</span>new_name<span class="ansi-blue-fg">[</span>i<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> value
<span class="ansi-green-intense-fg ansi-bold">    520</span> 
<span class="ansi-green-fg">--&gt; 521</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">return</span> function<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    522</span> 
<span class="ansi-green-intense-fg ansi-bold">    523</span>         <span class="ansi-green-fg">return</span> wrapper

<span class="ansi-green-fg">~/condajupynersc/lib/python3.6/site-packages/astropy/io/fits/file.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">(self, fileobj, mode, memmap, overwrite, cache)</span>
<span class="ansi-green-intense-fg ansi-bold">    191</span>             self<span class="ansi-blue-fg">.</span>_open_fileobj<span class="ansi-blue-fg">(</span>fileobj<span class="ansi-blue-fg">,</span> mode<span class="ansi-blue-fg">,</span> overwrite<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    192</span>         <span class="ansi-green-fg">elif</span> isinstance<span class="ansi-blue-fg">(</span>fileobj<span class="ansi-blue-fg">,</span> str<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 193</span><span class="ansi-red-fg">             </span>self<span class="ansi-blue-fg">.</span>_open_filename<span class="ansi-blue-fg">(</span>fileobj<span class="ansi-blue-fg">,</span> mode<span class="ansi-blue-fg">,</span> overwrite<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    194</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    195</span>             self<span class="ansi-blue-fg">.</span>_open_filelike<span class="ansi-blue-fg">(</span>fileobj<span class="ansi-blue-fg">,</span> mode<span class="ansi-blue-fg">,</span> overwrite<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/condajupynersc/lib/python3.6/site-packages/astropy/io/fits/file.py</span> in <span class="ansi-cyan-fg">_open_filename</span><span class="ansi-blue-fg">(self, filename, mode, overwrite)</span>
<span class="ansi-green-intense-fg ansi-bold">    572</span> 
<span class="ansi-green-intense-fg ansi-bold">    573</span>         <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> self<span class="ansi-blue-fg">.</span>_try_read_compressed<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>name<span class="ansi-blue-fg">,</span> magic<span class="ansi-blue-fg">,</span> mode<span class="ansi-blue-fg">,</span> ext<span class="ansi-blue-fg">=</span>ext<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 574</span><span class="ansi-red-fg">             </span>self<span class="ansi-blue-fg">.</span>_file <span class="ansi-blue-fg">=</span> fileobj_open<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>name<span class="ansi-blue-fg">,</span> IO_FITS_MODES<span class="ansi-blue-fg">[</span>mode<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    575</span>             self<span class="ansi-blue-fg">.</span>close_on_error <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">True</span>
<span class="ansi-green-intense-fg ansi-bold">    576</span> 

<span class="ansi-green-fg">~/condajupynersc/lib/python3.6/site-packages/astropy/io/fits/util.py</span> in <span class="ansi-cyan-fg">fileobj_open</span><span class="ansi-blue-fg">(filename, mode)</span>
<span class="ansi-green-intense-fg ansi-bold">    394</span>     &#34;&#34;&#34;
<span class="ansi-green-intense-fg ansi-bold">    395</span> 
<span class="ansi-green-fg">--&gt; 396</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">return</span> open<span class="ansi-blue-fg">(</span>filename<span class="ansi-blue-fg">,</span> mode<span class="ansi-blue-fg">,</span> buffering<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    397</span> 
<span class="ansi-green-intense-fg ansi-bold">    398</span> 

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;/global/cscratch1/sd/keskital/s4sim/reference_tool/out/00000000/pole_atmosphere_SAT_LFS1_filtered_telescope_all_time_all_bmap.fits&#39;</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="k">import</span> <span class="n">fits</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">output_map</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">read_map</span><span class="p">(</span>
    <span class="s2">&quot;output/cmbs4_sky_atmosphere_noise_KCMB_SAT-LFS1_nside512_1_of_1.fits&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
<span class="n">h</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">header</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">header_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">header</span><span class="p">}</span>
<span class="k">assert</span> <span class="n">header_dict</span><span class="p">[</span><span class="s2">&quot;SW_VERS&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">__version__</span>
<span class="k">assert</span> <span class="n">header_dict</span><span class="p">[</span><span class="s2">&quot;SOFTWARE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;s4_design_sim_tool&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">output_map</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">output_map</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">output_map</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mf">1e-2</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">output_map</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mf">1e-2</span><span class="p">,</span> \
    <span class="s2">&quot;Amplitude check failed&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hp</span><span class="o">.</span><span class="n">mollview</span><span class="p">(</span><span class="n">output_map</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">min</span><span class="o">=-</span><span class="mf">1e-4</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;K&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Total I&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hp</span><span class="o">.</span><span class="n">mollview</span><span class="p">(</span><span class="n">output_map</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="o">=-</span><span class="mf">1e-3</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;K&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Total Q&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hp</span><span class="o">.</span><span class="n">mollview</span><span class="p">(</span><span class="n">output_map</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">min</span><span class="o">=-</span><span class="mf">1e-3</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;K&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Total U&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

